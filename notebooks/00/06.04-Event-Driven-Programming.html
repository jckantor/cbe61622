
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Event Driven Programming &#8212; CBE 41622/61622 Laboratory Instrumentation and Measurement</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="PIO Programming" href="06.05-PIO-Programming.html" />
    <link rel="prev" title="Coding Paradigms for Device Control" href="06.03-Coding-Paradigms.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">CBE 41622/61622 Laboratory Instrumentation and Measurement</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    CBE 61622 Laboratory Measurement and Instrumentation
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01/00-CBE_61622.html">
   CBE 61622
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/01-Configuring-a-Workstation.html">
     Configuring a Workstation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/10-Workstation-Learning-Exercises.html">
     Workstation Learning Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/20-Projects.html">
     Semester Projects
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02/00-Raspberry-Pi-Pico.html">
   Raspberry Pi Pico
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/01-Getting_Started.html">
     Interfacing with Micropython on the Raspberry Pi Pico
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/02-Seeed_Grove_Pico_Starter_Kit.html">
     Grove Starter Kit for Raspberry Pi Pico
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/03-LCD1602.html">
     LCD1602
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03/00-Analog-Circuits-and-Signals.html">
   Analog Circuits and Signals
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/01-Linear-DC-Circuits.html">
     Basics of Linear DC Circuits
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/02-Operational-Amplifiers.html">
     Operational Amplifiers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04/08.00-Raspberry-Pi.html">
   Raspberry Pi
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/08.01-Raspberry-Pi-Setup.html">
     Setting up the Raspberry Pi for Lab Use
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/08.02-rpi-test-libraries.html">
     RPI Library tests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/08.03-rpi-picamera_test.html">
     RPI Camera Module
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05/00-computer-vision-applications.html">
   Computer Vision Applications
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/01-Computer-Vision.html">
     Computer Vision
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/02-getting-image-data.html">
     Getting Image Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/03-experiments-with-computer-vision.html">
     Experiments with Computer Vision
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/10.01-rpi-image-capture.html">
     Image Capture
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/10.02-Machine-Vision.html">
     Machine Vision Applications
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/10.11-Experiments-with-Computer-Vision.html">
     Experiments with Computer Vision
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/10.12-Test-Driven-Development.html">
     Test Driven Development
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/10.13-Computer-Vision-Application.html">
     Computer Vision Case Study: Creating an Application
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="00.html">
   Works in Progress
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="03.01-Low-Level-Measurment.html">
     Low-Level Measurement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03.02-Sampling-Continuous-Time-Signals.html">
     Sampling Continuous Time Signals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.00-Chemical_Instrumentation.html">
     Chemical Instrumentation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.10-Potentiostats-and-Galvanostats.html">
     Potentiostats and Galvanostats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06.00-Coding-for-Device-Control.html">
     Device Coding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06.01-Simple_Event_Loop.html">
     Managing Multiple Devices with an Event Loop
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06.02-Coding-Paradigms.html">
     Coding for Device Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06.03-Coding-Paradigms.html">
     Coding Paradigms for Device Control
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Event Driven Programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06.05-PIO-Programming.html">
     PIO Programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07.00-Interfacing_with_Laboratory_Equipment.html">
     Interfacing with Laboratory Equipment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07.01-Stepper-Motors.html">
     Stepper Motors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07.02-Stepper_Motor_Control_via_I2C.html">
     Stepper Motor Control via I2C
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07.03-Wifi-with-ESP-01.html">
     Wifi
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="09.00-Enabling_the_Internet_of_Things.html">
     Enabling the Internet of Things
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="09.01-Publishing_an_Experiment_via_MQTT.html">
     Publishing an Experiment via MQTT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="09.02-Accessing_a_Remote_Experiment_via_MQTT.html">
     Accessing a Remote Experiment via MQTT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="09.03-Miscellaneous_Notes.html">
     Accessing MQTT Devices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="A.00-Appendices.html">
     Python Source Library
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="A.01-Resources.html">
     Resources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="A.02-Downloading_Python_source_files_from_github.html">
     Downloading Python source files from github
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="A.03-Getting-Started-with-Pymata4.html">
     Getting Started with Pymata4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="A.04-Scheduling-Real-Time-Events-with-Simpy.html">
     Scheduling Real-Time Events with Simpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="B.00-Working_with_Particle.html">
     Working with Particle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="B.01-Particle_CLI.html">
     Particle Command Line Interface
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="B.02-Particle_Coding.html">
     Coding for Particle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="B.03-Particle-CLI.html">
     Particle Command Line Interface (CLI)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="B.04-Ultrasonic_Distance_Ranger.html">
     Ultrasonic Distance Ranger
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="B.05-Simple_Stop_Watch_using_Interrupts.html">
     Simple Stop Watch using Interrupts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="B.06-Communicating%20_via_TCP.html">
     Communicating via TCP
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/jckantor/cbe61622/main?urlpath=tree/notebooks/00/06.04-Event-Driven-Programming.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/jckantor/cbe61622/blob/main/notebooks/00/06.04-Event-Driven-Programming.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/jckantor/cbe61622"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/jckantor/cbe61622/issues/new?title=Issue%20on%20page%20%2Fnotebooks/00/06.04-Event-Driven-Programming.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/notebooks/00/06.04-Event-Driven-Programming.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#project-idea-ultra-low-cost-syring-pump">
   Project Idea: Ultra Low-Cost Syring Pump
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#button">
   Button
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polling">
     Polling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#timer">
     Timer
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interrupt-requests-and-service-routines-irq-isr">
   Interrupt Requests and Service Routines: IRQ/ISR
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#capturing-data-via-irq-isr-s">
     Capturing data via IRQ/ISR’s
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Event Driven Programming</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#project-idea-ultra-low-cost-syring-pump">
   Project Idea: Ultra Low-Cost Syring Pump
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#button">
   Button
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polling">
     Polling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#timer">
     Timer
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interrupt-requests-and-service-routines-irq-isr">
   Interrupt Requests and Service Routines: IRQ/ISR
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#capturing-data-via-irq-isr-s">
     Capturing data via IRQ/ISR’s
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="event-driven-programming">
<h1>Event Driven Programming<a class="headerlink" href="#event-driven-programming" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-micropython notranslate"><div class="highlight"><pre><span></span>%serialconnect
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found serial ports: /dev/cu.usbmodem14301, /dev/cu.Bluetooth-Incoming-Port 
<span class=" -Color -Color-Blue">Connecting to --port=/dev/cu.usbmodem14301 --baud=115200 </span>
<span class=" -Color -Color-Blue">Ready.</span>

</pre></div>
</div>
</div>
</div>
<section id="project-idea-ultra-low-cost-syring-pump">
<h2>Project Idea: Ultra Low-Cost Syring Pump<a class="headerlink" href="#project-idea-ultra-low-cost-syring-pump" title="Permalink to this headline">#</a></h2>
<p>Syringe pumps provide a convenient means of metering flows in microfluidic experiments. Conventional laboratory-grade syringe pumps are expensive, on the order of several hundreds to several thousand dollars, which stands in the way of using microfluidics as a platform for low-cost experimentation.</p>
<p>In the last decade there have been many reports of open-source, low-cost syringe pumps. Typically these employ NEMA 17 stepper motors, an Arduino microcontroller, and 3D printed components and off-the-shelf hardware.</p>
<p>Here we explore the possibiity of even lower cost devices based on 28BYJ-48 stepper motors and Raspberry Pi Pico. Would it be possible to build a viable syringe pump for less than, say, $50?</p>
<p>Ideas …</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S246806721830052X#%21">OMIS: The Open Millifluidic Inquiry System for small scale chemical synthesis and analysis</a></p></li>
<li><p>28BYJ-48 Stepper motor with ULN2003 driver</p></li>
<li><p>Linear actuator</p>
<ul>
<li><p><a class="reference external" href="https://www.adafruit.com/product/1175">5mm to 8mm Flex shaft coupler</a></p></li>
<li><p><a class="reference external" href="https://www.ebay.com/itm/153907301881">Gear driven cart</a></p></li>
<li><p><a class="reference external" href="https://www.thingiverse.com/thing:539490">3D printed part</a></p></li>
<li><p><a class="reference external" href="https://github.com/koendv/paste_dispenser">Compact design by replacing plunger</a></p></li>
<li><p><a class="reference external" href="https://ieeexplore.ieee.org/document/8584685">Spur gear design</a></p></li>
<li><p><a class="reference external" href="https://www.instructables.com/Linear-Actuator-Stepper-Motor/">Traveling nut - ultra low cost</a></p></li>
<li><p><a class="reference external" href="https://www.thingiverse.com/thing:4774416">Traveling nut design</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://www.meddeviceonline.com/doc/3-way-check-valve-0001">3 way check valve</a> to enable automatic refilling of the syringe.</p></li>
<li><p><a class="reference external" href="https://www.amazon.com/s?k=glue+injector+syringe">Blunt tip dispensing Syringes</a></p></li>
<li><p><a class="reference external" href="https://store-usa.arduino.cc/products/arduino-nano-rp2040-connect-with-headers?selectedStore=us">Arduino Nano RP2040 Connect</a> to enable Bluetooth/WiFi connectivity.</p></li>
</ul>
</section>
<section id="button">
<h2>Button<a class="headerlink" href="#button" title="Permalink to this headline">#</a></h2>
<section id="polling">
<h3>Polling<a class="headerlink" href="#polling" title="Permalink to this headline">#</a></h3>
<p>As our first attempt at building a class for button, let’s consider a simple polling loop.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-micropython notranslate"><div class="highlight"><pre><span></span>%serialconnect

from machine import Pin
import time

btn = Pin(20, Pin.IN)

start = time.time()
while time.time() - start &lt;= 20:
    print(btn.value(), end=&quot;&quot;)
    time.sleep(1)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>serial exception on close write failed: [Errno 6] Device not configured
Found serial ports: /dev/cu.usbmodem14301, /dev/cu.Bluetooth-Incoming-Port 
<span class=" -Color -Color-Blue">Connecting to --port=/dev/cu.usbmodem14301 --baud=115200 </span>
<span class=" -Color -Color-Blue">Ready.</span>
111100001110000111111
</pre></div>
</div>
</div>
</div>
<p>Issues:</p>
<ul class="simple">
<li><p>How fast should we poll?</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time.sleep()</span></code> blocks anything else we may wish to do.</p></li>
<li><p>How do we handle multiple buttons that may require different sampling rates?</p></li>
</ul>
</section>
<section id="timer">
<h3>Timer<a class="headerlink" href="#timer" title="Permalink to this headline">#</a></h3>
<p>Microcontroller boards typically have timers to assist with coding time dependent operations. The Raspberry Pi Pico has a particularly effective implementation offering an unlimited number of timers based on a global microsecond timebase.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-micropython notranslate"><div class="highlight"><pre><span></span>%serialconnect

from machine import Pin, Timer
import time

btn = Pin(20, Pin.IN)

def check_btn(timer):
    global btn
    print(btn.value(), end=&quot;&quot;)

start = time.time()
tim = Timer(freq=1, mode=Timer.PERIODIC, callback=check_btn)

time.sleep(20)
tim.deinit()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found serial ports: /dev/cu.usbmodem14301, /dev/cu.Bluetooth-Incoming-Port 
<span class=" -Color -Color-Blue">Connecting to --port=/dev/cu.usbmodem14301 --baud=115200 </span>

**[ys] &lt;class &#39;serial.serialutil.SerialException&#39;&gt;
**[ys] device reports readiness to read but returned no data (device disconnected or multiple access on port?)


**[ys] &lt;class &#39;serial.serialutil.SerialException&#39;&gt;
**[ys] read failed: [Errno 6] Device not configured

<span class=" -Color -Color-Blue">Ready.</span>


***OSError [Device not configured]
</pre></div>
</div>
</div>
</div>
<p>How could we handle multiple buttons?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-micropython notranslate"><div class="highlight"><pre><span></span>from machine import Pin, Timer
import time

btn1 = Pin(20, Pin.IN)
btn2 = Pin(21, Pin.IN)
btn3 = Pin(22, Pin.IN)

def check_btn1(timer):
    global btn1
    print(f&quot;btn1 = {btn1.value()}&quot;)
    
def check_btn2(timer):
    global btn2
    print(f&quot;btn2 = {btn2.value()}&quot;)
    
def check_btn3(timer):
    global btn3
    print(f&quot;btn3 = {btn3.value()}&quot;)

start = time.time()
tim1 = Timer(freq=1, mode=Timer.PERIODIC, callback=check_btn1)
tim2 = Timer(freq=0.5, mode=Timer.PERIODIC, callback=check_btn2)
tim3 = Timer(freq=2, mode=Timer.PERIODIC, callback=check_btn3)
time.sleep(20)
tim1.deinit()
tim2.deinit()
tim3.deinit()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>btn3 = 1
btn1 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn2 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn2 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn3 = 1
btn3 = 1
btn1 = 0
btn2 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn3 = 1
btn3 = 1
btn1 = 0
btn2 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn2 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn2 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn2 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn2 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn2 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn3 = 1
btn3 = 1
btn1 = 1
btn2 = 1
</pre></div>
</div>
</div>
</div>
<p>Obviously this is getting very clumsy.</p>
<ul class="simple">
<li><p>Because buttons must be declared global, each button requires a unique function</p></li>
<li><p>Buttons that are sampled slowly also respond very slowly, buttons must be held down for up to one full sampling period.</p></li>
<li><p>There are serious limitations on what can be included in a callback function. Cannot allocate new memory during a callback.</p></li>
</ul>
<p>We could use a functional programming technique known as “closures” to create functions</p>
</section>
</section>
<section id="interrupt-requests-and-service-routines-irq-isr">
<h2>Interrupt Requests and Service Routines: IRQ/ISR<a class="headerlink" href="#interrupt-requests-and-service-routines-irq-isr" title="Permalink to this headline">#</a></h2>
<p>Microcontrollers often incorporate hardware mechanisms to interrupt normal execution to service “interrupts”. The Raspberry Pi Pico supports a number of different interrupts, and the MicroPython interpreter provides simplified access that makes them relatively easy and safe to use.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.micropython.org/en/latest/reference/isr_rules.html">Writing interrupt handlers</a></p></li>
</ul>
<p>Here we set up MicroPython to respond to interrupts on a GPIO pin. The possible triggers include</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Pin.IRQ_FALLING</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Pin.IRQ_RISING</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Pin.IRQ_LOW_VALUE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Pin.IRQ_HIGH_VALUE</span></code></p></li>
</ul>
<p>These triggers can be combined using the Python OR <code class="docutils literal notranslate"><span class="pre">|</span></code> operator. For many applications, triggering on a falling or rising edge is often the method of choice. Consult the MicroPython documentation for other options.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-micropython notranslate"><div class="highlight"><pre><span></span>%serialconnect 

from machine import Pin
import time

btn = Pin(20, Pin.IN)
led = Pin(25, Pin.OUT)

start = time.time()

def btn_isr(_):
    led.toggle()
    
btn.irq(btn_isr, trigger=Pin.IRQ_FALLING)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>serial exception on close write failed: [Errno 6] Device not configured
Found serial ports: /dev/cu.usbmodem14401, /dev/cu.Bluetooth-Incoming-Port 
<span class=" -Color -Color-Blue">Connecting to --port=/dev/cu.usbmodem14401 --baud=115200 </span>
<span class=" -Color -Color-Blue">Ready.</span>

</pre></div>
</div>
</div>
</div>
<p>Here’s a second example that adds a buzzer. The buzzer toggles on when the button is pressed, and toggles off when released.</p>
<p><strong>The pin assignments assume use of the Cytron Maker Pi Pico board. If so, be sure the buzzer on/off switch is in the “on” position.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-micropython notranslate"><div class="highlight"><pre><span></span>%serialconnect 

from machine import Pin, PWM
import time

btn20 = Pin(20, Pin.IN)
btn21 = Pin(21, Pin.IN)

led = Pin(25, Pin.OUT)
buzzer = PWM(Pin(18, Pin.OUT))

start = time.time()

def btn20_isr(_):
    led.toggle()
    
buzzer_on = False
buzzer.freq(500)
def btn21_isr(_):
    global buzzer_on
    if buzzer_on:
        buzzer.duty_u16(0)
        buzzer_on = False
    else:
        buzzer.duty_u16(1000)
        buzzer_on = True
    
btn20.irq(btn20_isr, trigger=Pin.IRQ_FALLING)
btn21.irq(btn21_isr, trigger=Pin.IRQ_FALLING | Pin.IRQ_RISING)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found serial ports: /dev/cu.usbmodem14401, /dev/cu.Bluetooth-Incoming-Port 
<span class=" -Color -Color-Blue">Connecting to --port=/dev/cu.usbmodem14401 --baud=115200 </span>
<span class=" -Color -Color-Blue">Ready.</span>

</pre></div>
</div>
</div>
</div>
<section id="capturing-data-via-irq-isr-s">
<h3>Capturing data via IRQ/ISR’s<a class="headerlink" href="#capturing-data-via-irq-isr-s" title="Permalink to this headline">#</a></h3>
<p>There are many tricky issues involved with capturing data through the IRQ/ISR mechanism. This is partly due to Python’s mechanism for creating and updating objects. Interrupting Python at precisely the moment new objects are being created can lead to data or memory corruption.</p>
<p>One useful technique is to use IRQ/ISR within the context of an object class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-micropython notranslate"><div class="highlight"><pre><span></span>%serialconnect

from machine import Pin
import time

class Button(object):
    def __init__(self, gpio):
        self.btn = Pin(gpio, Pin.IN)
        # set up IRQ
        self.btn.irq(self.isr, trigger=Pin.IRQ_FALLING)
        # flag and data
        self.pressed = False
        self.time_pressed = time.ticks_ms()
        
    def isr(self, t):
        self.pressed = True
        self.time_pressed = time.ticks_ms()
        
btn = Button(20)
start = time.ticks_ms()
for k in range(10):
    if btn.pressed:
        print(btn.time_pressed - start)
        btn.pressed = False
    time.sleep(1)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found serial ports: /dev/cu.usbmodem14401, /dev/cu.Bluetooth-Incoming-Port 
<span class=" -Color -Color-Blue">Connecting to --port=/dev/cu.usbmodem14401 --baud=115200 </span>
<span class=" -Color -Color-Blue">Ready.</span>
.7178
8803
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "micropython",
            path: "./notebooks/00"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'micropython'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="06.03-Coding-Paradigms.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Coding Paradigms for Device Control</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="06.05-PIO-Programming.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">PIO Programming</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Jeffrey C. Kantor<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>